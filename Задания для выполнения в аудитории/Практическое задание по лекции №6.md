# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: "–°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –∫–Ω–∏–≥ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ"

## –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~1 —á–∞—Å

## –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è
–ó–∞–∫—Ä–µ–ø–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –æ—Å–Ω–æ–≤–Ω—ã–µ concepts —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Python: —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.

---

## –ó–∞–¥–∞–Ω–∏–µ: "–ë–∏–±–ª–∏–æ—Ç–µ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"

```python
"""
–°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —É—á–µ—Ç–∞ –∫–Ω–∏–≥ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:

1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö 'library.db' —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:
   - 'books' (id, title, author, year, genre, is_available)
   - 'readers' (id, name, email, phone, registration_date)
   - 'borrowings' (id, book_id, reader_id, borrow_date, return_date)

2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å LibraryManager —Å –º–µ—Ç–æ–¥–∞–º–∏:
   - add_book(), add_reader()
   - borrow_book(), return_book()
   - find_available_books(), get_reader_borrowings()

3. –û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
   - –ü—Ä–∏ –≤—ã–¥–∞—á–µ –∫–Ω–∏–≥–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –∫–Ω–∏–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –∫–Ω–∏–≥–∏ –ø—Ä–∏ –≤—ã–¥–∞—á–µ/–≤–æ–∑–≤—Ä–∞—Ç–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤—ã–¥–∞—á–∏/–≤–æ–∑–≤—Ä–∞—Ç–∞
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏
"""
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:

**1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**
```sql
-- –ö–Ω–∏–≥–∏
CREATE TABLE books (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    author TEXT NOT NULL,
    year INTEGER,
    genre TEXT,
    is_available BOOLEAN DEFAULT 1
);

-- –ß–∏—Ç–∞—Ç–µ–ª–∏  
CREATE TABLE readers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE,
    phone TEXT,
    registration_date DATE DEFAULT CURRENT_DATE
);

-- –í—ã–¥–∞—á–∏ –∫–Ω–∏–≥
CREATE TABLE borrowings (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    book_id INTEGER NOT NULL,
    reader_id INTEGER NOT NULL,
    borrow_date DATE DEFAULT CURRENT_DATE,
    return_date DATE,
    FOREIGN KEY (book_id) REFERENCES books(id),
    FOREIGN KEY (reader_id) REFERENCES readers(id)
);
```

**2. –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ LibraryManager:**

```python
class LibraryManager:
    def __init__(self, db_path='library.db'):
        self.db_path = db_path
        self._init_db()
    
    def _init_db(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü"""
        pass
    
    def add_book(self, title, author, year=None, genre=None):
        """–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É"""
        pass
    
    def add_reader(self, name, email=None, phone=None):
        """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª—è"""
        pass
    
    def borrow_book(self, book_id, reader_id):
        """
        –í—ã–¥–∞—Ç—å –∫–Ω–∏–≥—É —á–∏—Ç–∞—Ç–µ–ª—é
        - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–∏–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
        - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–Ω–∏–≥–∏
        - –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –≤—ã–¥–∞—á–µ
        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        """
        pass
    
    def return_book(self, borrowing_id):
        """
        –í–µ—Ä–Ω—É—Ç—å –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
        - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–Ω–∏–≥–∏
        - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É –≤–æ–∑–≤—Ä–∞—Ç–∞
        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        """
        pass
    
    def find_available_books(self, author=None, genre=None):
        """–ù–∞–π—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏ (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –∞–≤—Ç–æ—Ä—É/–∂–∞–Ω—Ä—É)"""
        pass
    
    def get_reader_borrowings(self, reader_id):
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –≤—ã–¥–∞—á —á–∏—Ç–∞—Ç–µ–ª—è"""
        pass
    
    def get_overdue_borrowings(self, days=30):
        """–ù–∞–π—Ç–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –≤—ã–¥–∞—á–∏ (–±–æ–ª—å—à–µ N –¥–Ω–µ–π)"""
        pass
```

**3. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
def main():
    library = LibraryManager()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–∏–≥–∏
    library.add_book("–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ", "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", 1866, "–†–æ–º–∞–Ω")
    library.add_book("–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞", "–ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤", 1967, "–†–æ–º–∞–Ω")
    library.add_book("1984", "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª", 1949, "–ê–Ω—Ç–∏—É—Ç–æ–ø–∏—è")
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —á–∏—Ç–∞—Ç–µ–ª–µ–π
    library.add_reader("–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤", "ivan@mail.com", "+79161234567")
    library.add_reader("–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤", "petr@mail.com", "+79167654321")
    
    # –í—ã–¥–∞–µ–º –∫–Ω–∏–≥–∏
    library.borrow_book(1, 1)  # –ò–≤–∞–Ω –±–µ—Ä–µ—Ç "–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ"
    library.borrow_book(2, 2)  # –ü–µ—Ç—Ä –±–µ—Ä–µ—Ç "–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞"
    
    # –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–¥–∞—Ç—å —É–∂–µ –∑–∞–Ω—è—Ç—É—é –∫–Ω–∏–≥—É
    try:
        library.borrow_book(1, 2)  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
    
    # –ò—â–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏
    available = library.find_available_books(author="–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª")
    print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏ –û—Ä—É—ç–ª–ª–∞:", available)
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–∏–≥—É
    library.return_book(1)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–Ω–∏–≥–∞ —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
    available = library.find_available_books()
    print("–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏:", available)

if __name__ == "__main__":
    main()
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (sqlite3.IntegrityError, sqlite3.OperationalError)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤—ã–¥–∞—á–∏/–≤–æ–∑–≤—Ä–∞—Ç–∞
- –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä–µ–π (row_factory)

### üéØ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:
- –ù–µ–ª—å–∑—è –≤—ã–¥–∞—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—É—é –∫–Ω–∏–≥—É
- –ü—Ä–∏ –≤—ã–¥–∞—á–µ –∫–Ω–∏–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –µ—ë —Å—Ç–∞—Ç—É—Å
- –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫–Ω–∏–≥–∞ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–π
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å email —á–∏—Ç–∞—Ç–µ–ª–µ–π

### üìä –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
```
–ö–Ω–∏–≥–∞ '–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ' —É—Å–ø–µ—à–Ω–æ –≤—ã–¥–∞–Ω–∞ —á–∏—Ç–∞—Ç–µ–ª—é –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
–û—à–∏–±–∫–∞: –ö–Ω–∏–≥–∞ —É–∂–µ –≤—ã–¥–∞–Ω–∞ –¥—Ä—É–≥–æ–º—É —á–∏—Ç–∞—Ç–µ–ª—é
–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏ –û—Ä—É—ç–ª–ª–∞: [{'id': 3, 'title': '1984', 'author': '–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª', ...}]
–ö–Ω–∏–≥–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
```

---

## –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

<details>
<summary>üí° –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫</summary>

```python
# 1. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏
from datetime import datetime, timedelta

# 2. –ü—Ä–∏–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
def borrow_book(self, book_id, reader_id):
    try:
        with sqlite3.connect(self.db_path) as conn:
            conn.row_factory = sqlite3.Row
            cursor = conn.cursor()
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–∏–≥–∏
            cursor.execute("SELECT is_available FROM books WHERE id = ?", (book_id,))
            book = cursor.fetchone()
            
            if not book:
                raise ValueError("–ö–Ω–∏–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            if not book['is_available']:
                raise ValueError("–ö–Ω–∏–≥–∞ —É–∂–µ –≤—ã–¥–∞–Ω–∞")
            
            # –í—ã–¥–∞–µ–º –∫–Ω–∏–≥—É (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è)
            cursor.execute(
                "UPDATE books SET is_available = 0 WHERE id = ?", 
                (book_id,)
            )
            cursor.execute(
                """INSERT INTO borrowings (book_id, reader_id) 
                   VALUES (?, ?)""", 
                (book_id, reader_id)
            )
            
    except sqlite3.Error as e:
        print(f"–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return False
    except ValueError as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
        return False
    
    return True

# 3. –î–ª—è –ø–æ–∏—Å–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
def find_available_books(self, author=None, genre=None):
    query = "SELECT * FROM books WHERE is_available = 1"
    params = []
    
    if author:
        query += " AND author LIKE ?"
        params.append(f"%{author}%")
    if genre:
        query += " AND genre LIKE ?" 
        params.append(f"%{genre}%")
    
    # –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞...
```
</details>
